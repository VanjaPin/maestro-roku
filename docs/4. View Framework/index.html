<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Overview
    </title>
    <link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@10.7.2/styles/github.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
    <link rel="stylesheet" href="../style.css" />
</head>

<body>
    <div id="navbar">
        <a href="/index.html">
            <div>Maestro - development framework for roku applications</div>
        </a>
        <a href="https://github.com/georgejecook/maestro-roku" target="_blank" title="View project on GitHub">
            <svg xmlns="http://www.w3.org/2000/svg" style="fill: white" width="24" height="24" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
        </a>
    </div>
    <div id="body-area">
        <div id="sidebar">

            
                
                    <div class="folder">
                        
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../index.html">Maestro-roku</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <div class="folder">
                        
                            <a class="name entry" href="../1. About">1. About</a>
                        
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../1. About/index.html">Overview</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../1. About/start.html">Getting started</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../1. About/bsc-plugin.html">Bsc plugin</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../1. About/justification.html">Justification</a>
                
            
                            </div>
                        
                    </div>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <div class="folder">
                        
                            <a class="name entry" href="../2. Utils">2. Utils</a>
                        
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../2. Utils/index.html">Overview</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../2. Utils/mc.html">mc (maestro core utils)</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../2. Utils/mc.tasks.html">mc.tasks (maestro task utils)</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../2. Utils/mc.utils.Serialization.html">mc.utils.Serialization</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../2. Utils/mc.utils.Collections.html">mc.utils.Collections</a>
                
            
                            </div>
                        
                    </div>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <div class="folder">
                        
                            <a class="name entry" href="../3. Node Classes">3. Node Classes</a>
                        
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../3. Node Classes/index.html">Overview</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../3. Node Classes/testing.html">Testing</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../3. Node Classes/config.html">Config</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../3. Node Classes/how-to-write.html">How to write</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../3. Node Classes/implemenation.html">Implementation details</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../3. Node Classes/node-task.html">Node tasks</a>
                
            
                            </div>
                        
                    </div>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <div class="folder">
                        
                            <a class="name entry" href="">4. View Framework</a>
                        
                        
                            <div class="children">
                                
                
                    <a class="entry" href="index.html">Overview</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="base-screen.html">BaseScreen</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="base-view.html">BaseView</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="aggregate-views.html">Aggregate Views</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="view-transitions.html">View Transitions</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="component-lifecycle.html">Component lifecycle</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="mixins.html">Mixins</a>
                
            
                            </div>
                        
                    </div>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <div class="folder">
                        
                            <a class="name entry" href="../5. MVVM Framework">5. MVVM Framework</a>
                        
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../5. MVVM Framework/index.html">Overview</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../5. MVVM Framework/observables-and-vms.html">Observables and Viewmodels</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../5. MVVM Framework/xml-bindings.html">XML binding syntax</a>
                
            
                            </div>
                        
                    </div>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <div class="folder">
                        
                            <a class="name entry" href="../6. IOC Framework">6. IOC Framework</a>
                        
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../6. IOC Framework/index.html">Overview</a>
                
            
                            </div>
                        
                    </div>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <div class="folder">
                        
                            <a class="name entry" href="../7. More maestro goodness">7. More maestro goodness</a>
                        
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../7. More maestro goodness/index.html">Overview</a>
                
            
                            </div>
                        
                    </div>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <div class="folder">
                        
                            <a class="name entry" href="../8. List Component">8. List Component</a>
                        
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../8. List Component/sample.html">Sample</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../8. List Component/getting-started.html">Getting Started</a>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../8. List Component/index.html">Overview</a>
                
            
                            </div>
                        
                    </div>
                
            
                            </div>
                        
                            <div class="children">
                                
                
                    <div class="folder">
                        
                            <a class="name entry" href="../9. Debugging">9. Debugging</a>
                        
                        
                            <div class="children">
                                
                
                    <a class="entry" href="../9. Debugging/index.html">Debugging</a>
                
            
                            </div>
                        
                    </div>
                
            
                            </div>
                        
                    </div>
                
            

            
                </br>
                </br>
                </br>
                </br>

              Docs by <a href='https://github.com/TwitchBronBron/statigen'>statigen</a>

        </div>
        <div id="content">
            <a href="#overview"><h2 id="overview">Overview</h2></a><p>The View framework allows us to generate Roku screens and components, which have a known lifecycle. If you&#39;ve done much Roku dev, you know how little of a framework exists for reasoning about a view&#39;s lifecycle events, such as being shown, getting focus, keys, etc. The Base view classes allow us to simply override abstract functions to seamlessly get lifecycle hooks for:</p>
<ul>
<li>instantiation and destruction</li>
<li>adding to and removal from container views</li>
<li>showing and hiding</li>
<li>key presses</li>
<li>focusing of views, or their children</li>
</ul>
<p>In addition the view framework contains many base classes that can be used</p>
<a href="#mixins"><h2 id="mixins">Mixins</h2></a><p>Maestro makes use of many different mixin classes, which handle different aspects of view management (e.g. utils, focus, key handling), and then bundles these together in base classes (views and screens).</p>
<p>Aggregate views for tab (i.e. iOS style TabController navigation) and stack (i.e. iOS style NavController navigation) are provided</p>
<a href="#loading-styles-and-bundles"><h2 id="loading-styles-and-bundles">Loading styles and bundles</h2></a><p>A great way of making maestro apps is to use nodeclasses, with json view definitions. It has many benefits:</p>
<ul>
<li>easy to extract json from tools like figma/zeplin via plugins</li>
<li>easy to serve json for your views from a CMS/api</li>
<li>json views don&#39;t require pre-compile steps, and you control when they get instantiated, giving more performance flexibility</li>
<li>localizations are super easy, simply call <code>setDefaultLocale(locale)</code> on your <code>StyleManager</code></li>
</ul>
<a href="#styles-and-style-manager"><h3 id="styles-and-style-manager">Styles and Style manager</h3></a><ul>
<li>Styles are stored in the style manager. They are loaded from a json file.</li>
<li>Styles can reference other styles using `&quot;key&quot;: &quot;~other.key&quot; semantics.</li>
</ul>
<p>e.g.</p>
<p>style.json</p>
<pre><code>{
  &quot;fonts&quot;: {
    &quot;app&quot;: {
      &quot;title&quot;: &quot;SystemBold, 40&quot;,
      &quot;subtitle&quot;: &quot;SystemBold, 20&quot;,
    },
    &quot;menu&quot;: {
      &quot;normal&quot;: &quot;System, 30&quot;,
      &quot;focused&quot;: &quot;SystemBold, 30&quot;
      }
  }
}
</code></pre>
<a href="#style-references"><h3 id="style-references">Style references</h3></a><p>You can then reference these elements in other json styles.
e.g.</p>
<pre><code>MenuButton: {
  normalFontKey: &quot;~fonts.menu.normal&quot;,
  focusedFontKey: &quot;~fonts.menu.focused&quot;
}
</code></pre>
<p>Referencing in this way works for <em>any</em> style that is loaded.</p>
<a href="#loading-styles"><h3 id="loading-styles">Loading styles</h3></a><p>Styles are loaded into style manager with the <code>loadJson</code> method call.
e.g. - in your initialization</p>
<pre><code>      styleUrl = &quot;pkg:/meta/Styles.json&quot;
      m.log.info(&quot;loading styles from&quot;, styleUrl)

      styleManager = mc.createSGNode(&quot;mv_StyleManager&quot;, invalid, &quot;styleManager&quot;)
      m.setInstance(&quot;styleManager&quot;, styleManager)
      m.global.addFields({ &quot;styleManager&quot;: styleManager })

      styleJson = m.loadJson(styleUrl)
      styleManager@.setStyleJson(styleJson)
</code></pre>
<a href="#creating-views-from-json"><h3 id="creating-views-from-json">Creating views from json:</h3></a><p>Simply load your style (or any json), and use the maestro view (mv) utility method, as such:</p>
<pre><code>    private function createViews()
      style = m.styleManager@.getStyle(&quot;screens.SettingsScreen.views&quot;)
      m.createViewsFromStyleJson(style, m.top)
    end function
</code></pre>
<p>Note that creation is done view the <code>mc.createViewsFromStyleJson</code> method (which for convenience is in <code>BaseClass</code>, <code>BaseCell</code> and <code>BaseViewModel</code>, to facilitate testing)</p>
<a href="#rules"><h4 id="rules">Rules</h4></a><ul>
<li>The json must be an <code>array</code> of assocarray items, that represent each of your views,</li>
<li>each musth have a <code>_type</code> which conforms to a SG node type, or one of your nodes</li>
<li>if you use an <code>id</code> field, it will automatically set the same named field on your node class<ul>
<li>if it can&#39;t be found, you will be warned</li>
</ul>
</li>
</ul>
<a href="#observing"><h4 id="observing">observing</h4></a><ul>
<li>you can wire up observes directly in your view json by adding an <code>observe</code> associative array and specifying the field names and function as such:
`observe: {
&quot;selected&quot;: &quot;onSelected&quot;
&quot;focused&quot;: [&quot;onSelected&quot;, &quot;both&quot;, true]
}</li>
</ul>
<p>In the latter case we are using directives to guide how the observe should be setup (in this case, pass both the node and the value, and only fire it once.). The args in that case are:
`[ handler function name, send mode (both|node|none|value) - default value, fire once (true|false) - default false]</p>
<a href="#updating-views-from-json"><h3 id="updating-views-from-json">Updating views from json:</h3></a><p>When you update views, you provide an assocarray of views by their id, with the values you wish to change, and call the <code>mc.updateViewsWithStyleJson</code> method (which for convenience is in <code>BaseClass</code>, <code>BaseCell</code> and <code>BaseViewModel</code>, to facilitate testing)</p>
<pre><code>  m.updateViewsWithStyleJson(m.style.normal)
</code></pre>
<p>Note, the format for overriding here (an aa), will soon be updated to use the bundle override format described in the next section.</p>
<p>One can make it very trivial to update views, in response to certain states.</p>
<p>e.g. given a Button control:</p>
<pre><code>    private function applyState(isFocused as boolean, isDisabled as boolean) as void
      &#39;ensure view is correctly configured
      m.updateViewsWithStyleJson(m.style.normal)

      if isDisabled
        m.updateViewsWithStyleJson(m.style.disabled)
      else if isFocused
        m.updateViewsWithStyleJson(m.style.focused)
      end if
    end function
</code></pre>
<a href="#loading-bundles"><h3 id="loading-bundles">Loading bundles</h3></a><p>Bundles are blobs of json that can represent views or other data. They are loaded on a file by file basis, and have the ability to have language overrides (or any key for that matter).
They are stored in a special folder named NAME.bundle, with specifically named files, e.g:</p>
<pre><code>
NAME.bundle/
NAME.json - root file locale &quot;en&quot;
NAME.de.json - overrides, in &quot;de&quot; locale
NAME.fr.json - overrides, in &quot;fr&quot; locale
</code></pre>
<p>Note, the locale keys happen to be language codes here; but they could be anything. Casing is important and the naming must follow this convention. See <a href="../../src/source/view/SettingsScreen.spec.bundle">source/view/SettingsScreen.spec.bundle</a> for the exact format.</p>
<p>To use a bundle in your app, do the following:</p>
<pre><code>private function createViews()
bundle = m.styleManager@.loadBundle(&quot;pkg:/source/view/SettingsScreen.bundle&quot;)
m.createViewsFromStyleJson(bundle.views, m.top)
end function
</code></pre>
<a href="#bundle-locales"><h4 id="bundle-locales">Bundle locales</h4></a><ul>
<li>the default locale is <code>en</code></li>
<li>use <code>StyleManager.setDefaultLocale</code> to set a different locale for bundles</li>
<li>the <code>loadBundle</code> method takes an optional second parameter to override the locale</li>
</ul>
<a href="#notes"><h4 id="notes">Notes</h4></a><ul>
<li>Once a bundle is loaded, it is cached.</li>
<li>Multiple bundles overrides can be held in cache at any time (to support user language switching)</li>
<li>the default locale is &quot;en&quot;</li>
<li>&quot;en&quot; is considered the root json file in a bundle, and does not have a file extension</li>
<li>Bundles can use style references, for <em>any</em> loaded style that is stored in the StyleManager</li>
</ul>
            <div id="footer">
            </div>
        </div>
    </div>
    <script>hljs.highlightAll();</script>
</body>

</html>
